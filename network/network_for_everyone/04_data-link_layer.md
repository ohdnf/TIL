# 데이터 링크 계층: 랜에서 데이터 전송하기



## 데이터 링크 계층의 역할과 이더넷

### 이더넷(Ethernet)

데이터 링크 계층에서 정하는 **네트워크 장비 간에 신호를 주고받는 규칙** 중 하나를 말한다.

### CSMA/CD

Carrier Sense Multiple Access with Collsion Detection(반송파 감지 다중 접속 및 충돌 탐지)
허브는 들어온 데이터를 그대로 모든 포트에 보내므로 컴퓨터 여러 대가 동시에 데이터를 보내면 데이터들이 충돌할 수 있다. CSMA/CD는 케이블을 확인해 신호가 흐르지 않을 때 데이터를 보내도록 데이터 보내는 시점을 조절해 충돌을 방지한다.



## MAC 주소의 구조

### MAC 주소

랜 카드를 제조할 때 할당되는 전세계적으로 중복되지 않는 유일한 값이다. 물리주소라고도 부르며 48비트 숫자로 구성되어 있다.

```
<MAC 주소의 구성>
00-23-AE-D9-7A-9A

00-23-AE ==> 제조사 번호
D9-7A-9A ==> 일련 번호
```

### 프레임

OSI 모델에서 데이터 링크 계층, TCP/IP 모델에서 네트워크 계층에 해당하는 계층에서 **이더넷 헤더와 트레일러가 추가된 데이터**

```
프레임 = 이더넷 헤더 + 데이터 + 트레일러
```

#### 이더넷 헤더

```
이더넷 헤더(총 14바이트) = 목적지 MAC 주소(6바이트) + 출발지 MAC 주소(6바이트) + 유형(2바이트)
```

> **이더넷 유형**
> 이더넷으로 전송되는 상위 계층 프로토콜(IPv4, IPv6 등)을 식별하는 번호(16진수로 표현)

#### 트레일러

FCS(Frame Check Sequence)라고도 하며, 데이터 전송 도중 오류가 발생하는지 확인하는 용도로 사용한다.



## 스위치의 구조

### 스위치

_레이어 2 스위치(L2 Switch)_ 또는 _스위칭 허브_라고도 불린다. _데이터 링크 계층_에서 동작한다.

#### MAC 주소 테이블

스위치의 **포트 번호**와 해당 포트에 연결되어 있는 컴퓨터의 **MAC 주소**가 등록되는 데이터베이스

#### MAC 주소 학습 기능

프레임이 전송되면 MAC 주소 테이블을 확인하고 출발지 MAC 주소가 등록되어 있지 않으면 프레임을 송신한 포트와 출발지 MAC 주소를 테이블에 등록

#### 플러딩(flooding)

프레임의 목적지 MAC 주소가 MAC 주소 테이블에 등록되어 있지 않으면 허브처럼 송신 포트 이외 포트에 데이터를 전부 전송

#### MAC 주소 필터링

목적지 MAC 주소가 MAC 주소 테이블에 등록되어 있어 목적지 컴퓨터에만 데이터를 전송하는 것



## 데이터가 케이블에서 충돌하지 않는 구조

### 전이중 통신과 반이중 통신

#### 전이중(Full-Duplex) 통신

데이터의 송수신을 동시에 통신하는 방식. 데이터를 동시에 전송해도 충돌이 발생하지 않는다.

> - 컴퓨터를 직접 랜 케이블(**크로스 케이블**)로 연결하는 경우
> - 두 컴퓨터를 **스위치**로 연결하는 경우

#### 반이중(Half-Duplex) 통신

회선 하나로 송신과 수신을 번갈아가면서 통신하는 방식. 데이터를 동시에 전송하면 충돌이 발생

> - 두 컴퓨터가 송수신이 나누어져 있지 않은 **허브**로 연결된 경우



### 충돌 도메인

충돌이 발생할 때 그 영향이 미치는 범위

- 허브의 경우 접속된 모든 컴퓨터가 충돌 도메인
- 스위치의 경우 접속되어 있는 모든 컴퓨터에 영향을 미치지 않는다.



> ARP(Address Resolution Protocol)
>
> 목적지 컴퓨터의 IP 주소를 이용하여 MAC 주소를 찾기 위한 프로토콜입니다. 이더넷 프레임을 전송하려면 목적지 컴퓨터의 MAC 주소를 지정해야 합니다.
>
> ARP 요청(request)
>
> 출발지 컴퓨터가 목적지 MAC 주소를 모르면 네트워크에 브로드캐스트하는 것. 이 요청에 대해 지정된 IP 주소를 가지고 있지 않은 컴퓨터는 응답하지 않고, 지정된 IP 주소를 가진 컴퓨터만 MAC 주소로 ARP 응답(reply)을 보냅니다. 이것으로 출발지 컴퓨터는 MAC 주소를 얻고 이더넷 프레임을 만들 수 있습니다.
>
> ARP 테이블(table)
>
> 출발지 컴퓨터에서는 MAC 주소를 얻은 후에 MAC 주소와 IP 주소를 매핑해 메모리에 보관하는 곳입니다. 이후 데이터 통신은 자신의 컴퓨터에 보관된 ARP 테이블을 참고하여 전송합니다. 하지만 IP 주소가 변경되면 해당 MAC 주소도 함께 변경되므로 제대로 통신할 수 없습니다. 그래서 ARP 테이블에서는 보존 기간을 ARP 캐시로 지정하고 일정 시간이 지나면 삭제하고 다시 ARP 요청을 합니다.
>
> Windows cmd에서 ARP 캐시 내용 확인하는 명령어: `arp -a`



## 이더넷의 종류와 특징

### 이더넷 규격

| 규격 이름  | 통신 속도 | 케이블               | 케이블 최대 길이 | 표준화 연도 |
| ---------- | --------- | -------------------- | ---------------- | ----------- |
| 10BASE5    | 10Mbps    | 동축케이블           | 500m             | 1982        |
| 10BASE2    | 10Mbps    | 동축케이블           | 185m             | 1988        |
| 10BASE-T   | 10Mbps    | UTP케이블(Cat3이상)  | 100m             | 1990        |
| 100BASE-TX | 100Mbps   | UTP케이블(Cat5이상)  | 100m             | 1995        |
| 1000BASE-T | 1000Mbps  | UTP케이블(Cat5이상)  | 100m             | 1999        |
| 10GBASE-T  | 10Gbps    | UTP케이블(Cat6a이상) | 100m             | 2006        |

```
   10		BASE	-	T
통신 속도	전송 방식	케이블
```

